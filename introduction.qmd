---
title: "\\Analysis of Obesity Prevalence and Influencing Factors in the 2013â€“2016 Scottish Health Surveys"
subtitle: Group 6
author: Amina Rage (2652872R), Robin Purves (2763403P), Yassmine Boukhobezaa (2796790B), Yu Zhao (2724171Z)
format: html
editor: visual
execute: 
  echo: false
---

```{r}
#| echo: false
#| warning: false
#| message: false

library(dplyr)
library(ggplot2) 
library(performance)
library(tinytex)
library(kableExtra)
library(tidyverse)
library(tidymodels)
library(gt)
library(MASS)
library(patchwork)
library(moderndive)
library(gapminder)
library(sjPlot)
library(stats)
library(readr)
library(janitor)
library(ggstats)
library(skimr)


obesity <- read.csv("DAProject12.csv")
BMI <- obesity

```

# Introduction {#sec-intro}

Over the years, there has been an increase in the health awareness of the Scottish population, with a fear that the country as a whole is becoming overweight. The body mass index (BMI) is a quick way to measure weight relative to height, and screen for people that are underweight, overweight, or obese.

This report aims to explore changes in BMI trends in Scotland using data from the 2013--2016 Scottish Health Survey. Specifically, we seek to answer the following key questions:

1.  Has the BMI in Scotland changed over the given years of the Scottish Health Survey?
2.  Are there any difference inthe BMI distributions by age, gender, socioeconomic status or lifestyle factors?

By analyzing this data, we aim to identify patterns that could inform public health strategies and address potential risk factors contributing to obesity.

# Exploratory data analysis {#sec-expdata}

These statistics can be illustrated in @fig-bar1 below. We can also see that there are no significant change in the proportion of obese individuals between 2013 and 2016.

```{r}
#| echo: false
#| warning: false
#| fig-cap: bar plot of BMIgroup by year
#| label: fig-bar1
#| fig-height: 2
ggplot(obesity, aes(x = factor(Year), fill = BMIgroup)) +
  geom_bar(position = "fill") +
  labs(title = "BMI Group Proportion by Year", x = "Year", y = "Proportion") +
  theme_minimal()
```

Next, we want to explore the relationship between Age and BMIgroup.In @fig-box1 shows that the age distribution varies significantly across different BMI groups. Generally, obese individuals tend to be older, whereas the underweight group is comparatively younger. This indicates age is an important factor associated with BMI categories.

```{r}
#| echo: false
#| warning: false
#| fig-cap: "Box plot showing the relationship between Age and BMIgroup"
#| label: fig-box1
#| fig-height: 3

boxplot(Age ~ BMIgroup, data = obesity,
        main = "Age Distribution by BMI Group",
        xlab = "BMI Group",
        ylab = "Age")

```

Next, we analyse the relationship between BMI Group Proportion by Sex. In @fig-bar2 we see there are noticeable differences in BMI group proportions between males and females. Males appear slightly more likely to be overweight, whereas females show relatively higher proportions in the normal and obese categories. Gender thus influences BMI distribution patterns.

```{r}
#| echo: false
#| warning: false
#| fig-cap: Bar plot showing the relationship between Sex and BMIgroup
#| label: fig-bar2
#| fig-height: 2
ggplot(obesity, aes(x = Sex, fill = BMIgroup)) +
  geom_bar(position = "fill") +
  labs(title = "BMI Group Proportion by Sex", x = "Sex", y = "Proportion") +
  theme_minimal()
```

Finally, we want to assess the relationship between Education and BMIgroup. In @fig-bar3 shows that the education level is related to BMI groups. Individuals with higher educational qualifications generally have higher proportions of normal weight and lower proportions of obesity. Conversely, individuals with fewer or no qualifications show a greater proportion of obesity. Socio-economic factors, represented by education levels, clearly impact obesity rates.

```{r}
#| echo: false
#| warning: false
#| fig-cap: Bar plot showing the relationship between Education and BMIgroup
#| label: fig-bar3
#| fig-height: 3

ggplot(obesity, aes(x = Education, fill = BMIgroup)) +
  geom_bar(position = "fill") +
  labs(title = "BMI Group Proportion by Education", x = "Education", y = "Proportion") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
